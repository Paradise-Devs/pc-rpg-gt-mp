<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <link rel='stylesheet' href='../css/pcfw.css'>
        <link rel='stylesheet' href='../css/gui.css'>
        <link rel='stylesheet' href='../css/icons-fa.css'>
        <link rel='stylesheet' href='../css/icons-clothes.css'>
        <link rel='stylesheet' href='../css/icons-bodyparts.css'>
    </head>
    <body id="main">
        <div class="container-fluid">
            <pagetitle>Criar novo personagem</pagetitle>
            <block class="charcreator">
                <header>
                    A personalização do seu personagem é livre!
                    Uma maior gama de itens para personalização, está disponível para compra nas lojas de Los Santos.
                </header>
                <content>
                    <form>
                        <field>
                            <label>Personagem</label>
                            <input type="text" id="charname" placeholder="Nome do personagem" max="24" maxlength="24" required>
                            <help>Formato: Nome Sobrenome</help>
                        </field>
                        <gender>
                            <item class="male">
                                <i class="fa fa-male"></i>
                                <desc>Homem</desc>
                            </item>
                            <item class="female">
                                <i class="fa fa-female"></i>
                                <desc>Mulher</desc>
                            </item>
                        </gender>
                    </form>
                </content>
                <customization>
                    <category>
                        <header data-id="0">Cabeça <i class="fa fa-caret-down"></i></header>
                        <container>
                            <item>
                                <i class="bodyparts-face-of-a-woman-outline"></i>
                            </item>
                            <item>
                                <i class="bodyparts-eye-variant-with-enlarged-pupil"></i>
                            </item>
                            <item class="male">
                                <i class="bodyparts-young-male-black-short-hair-shape"></i>
                            </item>
                            <item class="male">
                                <i class="bodyparts-mustache-curled-tip-variant"></i>
                            </item>
                            <item class="female">
                                <i class="bodyparts-brunette-female-woman-long-hair"></i>
                            </item>
                            <item class="female">
                                <i class="bodyparts-closed-eyes-with-lashes-and-brows"></i>
                            </item>
                        </container>
                    </category>
                    <category>
                        <header data-id="1">Torso <i class="fa fa-caret-down"></i></header>
                        <container>
                            <item class="male" data-id="0">
                                <i class="clothes-shirt"></i>
                            </item>
                            <item class="male" data-id="1">
                                <i class="clothes-hoodie"></i>
                            </item>
                            <item class="male" data-id="2">
                                <i class="clothes-vest"></i>
                            </item>
                            <item class="male" data-id="12">
                                <i class="clothes-shirt"></i>
                            </item>
                            <item class="female">
                                <i class="clothes-shirt-2"></i>
                            </item>
                            <item class="female">
                                <i class="clothes-dress-3"></i>
                            </item>
                            <item class="female">
                                <i class="clothes-trench-coat"></i>
                            </item>
                        </container>
                    </category>
                    <category>
                        <header data-id="2">Pernas <i class="fa fa-caret-down"></i></header>
                        <container>
                            <item class="male" data-id="3">
                                <i class="clothes-jeans"></i>
                            </item>
                            <item class="male" data-id="4">
                                <i class="clothes-shorts"></i>
                            </item>
                            <item class="female">
                                <i class="clothes-jeans"></i>
                            </item>
                            <item class="female">
                                <i class="clothes-skirt"></i>
                            </item>
                            <item class="female">
                                <i class="clothes-shorts-1"></i>
                            </item>                            
                            <item class="male">
                                <i class="clothes-underwear"></i>
                            </item>
                        </container>
                    </category>
                    <category>
                        <header data-id="3">Pés <i class="fa fa-caret-down"></i></header>
                        <container>
                            <item class="male" data-id="5">
                                <i class="clothes-boot"></i>
                            </item>
                            <item class="male" data-id="6">
                                <i class="clothes-sneaker"></i>
                            </item>
                            <item class="male" data-id="7">
                                <i class="clothes-slipper"></i>
                            </item>
                            <item class="female">
                                <i class="clothes-high-heels"></i>
                            </item>
                            <item class="female">
                                <i class="clothes-sneaker"></i>
                            </item>
                            <item class="female">
                                <i class="clothes-slipper"></i>
                            </item>
                        </container>
                    </category>
                    <category>
                        <header data-id="-1">Acessórios <i class="fa fa-caret-down"></i></header>
                        <container>
                                <item class="male" data-id="8">
                                    <i class="clothes-tie"></i>
                                </item>
                                <item class="male" data-id="9">
                                    <i class="clothes-scarf"></i>
                                </item>
                                <item class="male" data-id="10">
                                    <i class="clothes-necklace"></i>
                                </item>
                                <item class="male" data-id="11">
                                    <i class="fa fa-ellipsis-h"></i>
                                </item>
                                <item class="female">
                                    <i class="clothes-tie"></i>
                                </item>
                                <item class="female">
                                    <i class="clothes-scarf"></i>
                                </item>
                                <item class="female">
                                    <i class="clothes-necklace"></i>
                                </item>
                                <item class="female">
                                    <i class="fa fa-ellipsis-h"></i>
                                </item>
                            </container>
                    </category>
                </customization>
                <footer class="right">
                    <error></error>
                    <loading><i class="fa fa-spinner faa-spin animated"></i></loading>
                    <button class="red" id="backBtn"><i class="fa fa-arrow-left"></i></button>
                    <button type="submit" id="submit">Criar</button>
                </footer>
            </block>
            <configurators>
                <config id="config1">
                    <div class="btn-group">
                        <button id="decreaseItem"><i class="fa fa-caret-left"></i></button>
                        <button class="counter" disabled>0/0</button>
                        <button id="increaseItem"><i class="fa fa-caret-right"></i></button>
                    </div>
                </config>
                <config id="config2">
                    <div class="btn-group">
                        <button id="decreaseItem2"><i class="fa fa-caret-left"></i></button>
                        <button class="counter" disabled>0/0</button>
                        <button id="increaseItem2"><i class="fa fa-caret-right"></i></button>
                    </div>
                </config>
            <configurators>
            <block class="sliders">
                <header>
                    Ajuste o configurador conforme as suas preferências.
                </header>
                <content>
                </content>
            </block>

        </div>
        <script src="../js/slider.js"></script>
        <script src="../js/jquery.js"></script>
        <script src="../js/tether.js"></script>
        <script src="../js/pcfw.js"></script>
        <script src="../js/character-components.js"></script>
        <script>

            // ------------- item selection -------------

            var gender = 0;
            var selected_item_type = null;
            var current_item_variation = 0;
            var current_item_last_index = 0;

            $("#config1").hide();
            $("#config2").hide();

            $("item").click(function ()
            {
                $(this).addClass('active').siblings().removeClass('active');

                $(this).parent().parent().siblings()
                    .find('container item')
                    .removeClass('active');

                if ($(this).data("id") == undefined)
                    return;

                selected_item_type = $(this).data("id");
                current_item_variation = 0;
                current_item_last_index = character_components[gender][selected_item_type].length - 1;

                $(".counter").html((current_item_variation + 1) + "/" + (current_item_last_index + 1));

                if (!$("#config1").is(":visible"))
                    $("#config1").show();

                if (selected_item_type == 2 && !$("#config2").is(":visible"))
                    $("#config2").show();
                else if (selected_item_type != 2 && $("#config2").is(":visible"))
                    $("#config2").hide();

                resourceCall("SelectCharacterComponent", JSON.stringify(character_components[gender][selected_item_type][current_item_variation]));
            });

            $("#decreaseItem").click(function ()
            {
                current_item_variation--;
                if (current_item_variation < 0)
                    current_item_variation = current_item_last_index;
                $(".counter").html((current_item_variation + 1) + "/" + (current_item_last_index + 1));

                resourceCall("resource.Sounds.PlaySelectSound");
                resourceCall("SelectCharacterComponent", JSON.stringify(character_components[gender][selected_item_type][current_item_variation]));
            });

            $("#increaseItem").click(function ()
            {
                current_item_variation++;
                if (current_item_variation > current_item_last_index)
                    current_item_variation = 0;
                $(".counter").html((current_item_variation + 1) + "/" + (current_item_last_index + 1));

                resourceCall("resource.Sounds.PlaySelectSound");
                resourceCall("SelectCharacterComponent", JSON.stringify(character_components[gender][selected_item_type][current_item_variation]));
            });

            // ------------- item selection -------------

            $("category container").hide();
            $("error").hide();
            $("customization").hide();

            $('input').keyup(function ()
            {
                if ($(this).hasClass('error'))
                {
                    $("error").hide();
                    $(this).removeClass('error');
                }
            });

            $('category header').click(function ()
            {
                $(this).parent().siblings().find('container').slideUp();
                $(this).parent().toggleClass('active');
                $("i", this).toggleClass('fa-caret-down fa-caret-up');
                $(this).siblings('container').slideToggle();
                $(this).parent().siblings().removeClass('active');
                $(this).parent().siblings().find('header i').addClass('fa-caret-down').removeClass('fa-caret-up');

                if ($("#config1").is(":visible"))
                    $("#config1").hide();

                if ($("#config2").is(":visible"))
                    $("#config2").hide();

                if ($(this).data("id") != undefined)
                {
                    resourceCall("resource.Sounds.PlaySelectSound");
                    resourceCall("MoveCameraPosition", $(this).data("id"));
                }
            });

            var regx = /^[A-Z][a-z]+\s[A-Z][a-z]+$/;
            $('#submit').click(function ()
            {
                if($("#charname").val().length < 8)
                    ShowError("Utilize no mínimo <b>8</b> caracteres.", "#charname");
                else if(!regx.test($("#charname").val()))
                    ShowError("Formato: <b>Nome Sobrenome</b>", "#charname");
                else if (!$("gender item").hasClass("active"))
                    ShowError("Selecione o sexo do personagem", "gender item");
            });

            $('gender item').on('click', function ()
            {
                $(this).addClass('active').siblings().removeClass('active');
                $("customization").slideDown();

                if ($("#config1").is(":visible"))
                    $("#config1").hide();

                if ($("#config2").is(":visible"))
                    $("#config2").hide();

                if ($(this).hasClass('male'))
                {
                    $('category container item.female').hide();
                    $('category container item.male').show();

                    gender = 0;
                    resourceCall("ChangeCharacterGender", 0);
                }
                else
                {
                    $('category container item.male').hide();
                    $('category container item.female').show();

                    gender = 1;
                    resourceCall("ChangeCharacterGender", 1);
                }                

                resourceCall("resource.Sounds.PlaySelectSound");
            });

            $('#backBtn').click(function ()
            {
                resourceCall("resource.Sounds.PlaySelectSound");
                resourceCall("GoBackToSelection");
            });

            function ShowError(message, input)
            {
                $('loading').hide();
                isSubmitting = false;

                $("error").html(message);
                $("error").show();
                $(input).addClass('error');
            }
        </script>
    </body>
</html>
